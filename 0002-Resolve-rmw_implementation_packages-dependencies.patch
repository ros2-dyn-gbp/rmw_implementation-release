From 16e3a0d676ee7578c94d658a7cc7f813e1f42240 Mon Sep 17 00:00:00 2001
From: Scott K Logan <logans@cottsay.net>
Date: Tue, 9 Mar 2021 15:57:20 -0800
Subject: [PATCH 2/2] Resolve rmw_implementation_packages dependencies

Require any RMW implementation at runtime, and suggest the default RMW,
`rmw_fastrtps_cpp` if weak dependencies are supported.

Signed-off-by: Scott K Logan <logans@cottsay.net>
---
 rpm/ros-rolling-rmw-implementation.spec | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/rpm/ros-rolling-rmw-implementation.spec b/rpm/ros-rolling-rmw-implementation.spec
index bfb2955b6d5b..e855f60cfa12 100644
--- a/rpm/ros-rolling-rmw-implementation.spec
+++ b/rpm/ros-rolling-rmw-implementation.spec
@@ -24,6 +24,10 @@ Release:        %{release}%{?release_suffix}
 Summary:        %{summary}
 Provides:       %{name}%{?_isa} = %{version}-%{release}
 Requires:       %{name}-runtime%{?_isa} = %{version}-%{release}
+Requires:       ros-%{ros_distro}(rmw_implementation_packages)(devel)(member)
+%if 0%{?with_weak_deps}
+Recommends:     ros-%{ros_distro}(rmw_fastrtps_cpp)(devel)
+%endif
 
 %description devel
 Proxy implementation of the ROS 2 Middleware Interface.
@@ -32,6 +36,10 @@ Proxy implementation of the ROS 2 Middleware Interface.
 %package runtime
 Release:        %{release}
 Summary:        %{summary}
+Requires:       ros-%{ros_distro}(rmw_implementation_packages)(member)
+%if 0%{?with_weak_deps}
+Recommends:     ros-%{ros_distro}(rmw_fastrtps_cpp)
+%endif
 
 %description runtime
 Proxy implementation of the ROS 2 Middleware Interface.
-- 
2.44.0

